<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" title="Main">
<head>
<meta charset="UTF-8">
<title>Test</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="refresh" content="10">
<style>

</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script>

$(document).ready(function() {
const apiKey='AIzaSyDx6kW6R0eV0vC2XH1KJRVdia0lrsfKJTk'; 
const spreadsheetId = '1A51diw0kQ4m1mmp4Bsn5AxWAmZ-xQGunoUht5PVhb4k'; 
const sheetName = 'Sheet1'; 
var data ;
async function getNameList(){
	var response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${apiKey}`);
	data = await response.json();
	return data.values;
}
async function getData(){
const nameList = await getNameList();


$.each(nameList, function (i, item) {
	console.log(item[0]);
	console.log(item[2]);
	if (item[2] == 'TRUE')
		$('#attendants').append('<tr><td>'+item[0]+'</td></tr>');
    });
}

getData();
});
</script>
</head>
<body>
<h1>Testing</h1>
<h2>二零二X年XX月XX日</h2>
<br>
<div id="vote">

<form>

<div id="result">
<table class="center" id="attendants">
	
</table>
</br>
</br>
</div>

<span id="candidate"></span></br>

<span id="voteNum"></span></br>

<span id="oper"></span></br>

<br>
<input type="button" id="sum" name="sum" value="結果" class="button result" hidden="true">


</form>
</div>

<script>
	
</script>
</body>
</html>
